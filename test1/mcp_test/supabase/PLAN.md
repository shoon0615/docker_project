# Notion 클론 프로젝트 개발 계획

## 1. 개요
Next.js와 Supabase를 사용하여 Notion과 유사한 문서 관리 애플리케이션을 개발합니다. 사용자는 GitHub 계정으로 소셜 로그인할 수 있으며, Blocknote 에디터를 사용하여 문서를 실시간으로 작성, 조회, 수정, 삭제할 수 있습니다.

## 2. 기술 스택
- **프레임워크**: Next.js (App Router)
- **언어**: JavaScript
- **데이터베이스**: Supabase DB
- **인증**: Supabase Auth
- **에디터**: Blocknote
- **스타일링**: Tailwind CSS

## 3. 데이터베이스 스키마 (Supabase)
### `notes` 테이블
문서의 내용을 저장하는 테이블입니다.
| 컬럼명      | 타입      | 설명                                                    | 제약 조건                        |
|-------------|-----------|---------------------------------------------------------|----------------------------------|
| `id`        | `uuid`    | 고유 식별자 (Primary Key)                               | `default uuid_generate_v4()`     |
| `user_id`   | `uuid`    | 작성자 ID (Foreign Key)                                 | `references auth.users(id)`      |
| `title`     | `text`    | 문서 제목                                               | `not null`                       |
| `content`   | `jsonb`   | 문서 내용 (Blocknote 에디터의 JSON 출력)                |                                  |
| `created_at`| `timestamptz` | 생성 일시                                               | `default now()`                  |
| `updated_at`| `timestamptz` | 수정 일시                                               | `default now()`                  |

**Row Level Security (RLS) 정책:**
- **SELECT**: 사용자는 본인이 작성한 문서만 조회할 수 있습니다.
- **INSERT**: 사용자는 자신의 `user_id`로만 문서를 생성할 수 있습니다.
- **UPDATE**: 사용자는 본인이 작성한 문서만 수정할 수 있습니다.
- **DELETE**: 사용자는 본인이 작성한 문서만 삭제할 수 있습니다.

## 4. 페이지 구성 (Next.js App Router)
- `/` : 메인 페이지. 로그인한 사용자의 문서 목록을 보여주거나, 로그인하지 않은 사용자에게는 로그인 페이지로 안내합니다.
- `/login` : 로그인 페이지. "Sign in with GitHub" 버튼이 포함됩니다.
- `/auth/callback` : Supabase OAuth 콜백을 처리하기 위한 서버 라우트.
- `/notes/new` : 새 문서를 작성하는 페이지.
- `/notes/[id]` : 특정 문서를 조회하고 수정하는 페이지.

## 5. 세부 기능 개발 계획

### 1단계: 프로젝트 초기 설정 (완료)
- Next.js 프로젝트 생성, 라이브러리 설치, Supabase 연동 및 클라이언트 초기화 로직 구현 완료.

### 2단계: DB 구현 (완료)
- `notes` 테이블 생성 및 RLS 정책 설정 완료.

### 3단계: 인증 기능 구현 (완료)
- GitHub OAuth, 로그인/로그아웃, 세션 관리 기능 구현 완료.

### 4단계: 글 작성 및 목록 조회 기능 구현
1.  **글 작성 페이지 (`/notes/new`)**:
    - Blocknote 에디터 컴포넌트를 페이지에 통합.
    - 제목(title)을 입력할 `<input>` 필드와 이를 활성화하는 체크박스 UI 제공.
    - **자동 제목 생성**: 체크박스가 해제된 상태(기본값)에서 제목 `<input>`은 비활성화되고, 저장 시 에디터의 첫 번째 블록 내용이 제목으로 자동 사용됨. (이때 원본 콘텐츠는 그대로 유지하여 저장)
    - **수동 제목 생성**: 체크박스 선택 시 제목 `<input>`이 활성화되어 직접 제목을 입력할 수 있음.
    - **저장**: '저장' 버튼 클릭 시, 결정된 제목과 Blocknote의 `editor.document` 전체 내용을 `notes` 테이블에 `insert`.
    - **리디렉션**: 저장 후 메인 페이지 (`/`)로 리디렉션.
2.  **메인 페이지 (`/`)**:
    - 로그인한 사용자의 `user_id`를 기준으로 `notes` 테이블에서 글 목록을 `select`.
    - 각 글의 제목과 생성 날짜 등을 표시하고, 클릭 시 해당 글의 조회 및 수정 페이지 (`/notes/[id]`)로 이동하는 링크 제공.

### 5단계: 글 수정 및 삭제 기능 구현
1.  **글 조회 및 수정 페이지 (`/notes/[id]`)**:
    - URL의 `[id]`를 파라미터로 받아 `notes` 테이블에서 해당 문서를 `select`.
    - **제목**: 제목은 수정 불가능한 텍스트(<h1>)로 표시.
    - **내용**: Blocknote 에디터를 `editable={true}` 모드로 설정하고, 불러온 `content` (JSON)를 렌더링하여 내용 수정이 가능하도록 함.
    - **저장**: '저장 후 닫기' 버튼 클릭 시, 수정된 `content`만 `notes` 테이블에 `update`. 업데이트 후 메인 페이지 (`/`)로 리디렉션.
2.  **글 삭제 기능**:
    - '삭제' 버튼 클릭 시 `window.confirm`을 통해 사용자에게 재확인 요청.
    - 확인 시 `deleteNote` 서버 액션을 호출하여 `notes` 테이블에서 해당 데이터를 `delete`.
    - 삭제 후 메인 페이지 (`/`)로 리디렉션.

---

# Notion 클론 UI 구현 계획 (참고용)

이 계획은 제공된 이미지와 기능 설명을 기반으로 `notion-clone` 프로젝트에 Notion과 유사한 UI를 구현하기 위한 단계를 설명합니다.

## I. 설정 및 핵심 레이아웃
... (이하 내용은 이전과 동일) ...